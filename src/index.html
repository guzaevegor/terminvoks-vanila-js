<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theremin App</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
<div class="header">
    <h1 class="title">Theremin App</h1>
    <p class="slogan">Feel the sound, shape the waves</p>
</div>

<div class="main-content">
    <canvas id="myCanvas"></canvas>
</div>

<button class="settings-button" onclick="toggleSettings()">‚öôÔ∏è</button>
<button class="mute-button" onclick="toggleMute()">üîä</button>


<div class="settings-panel" id="settingsPanel">
    <h2>Settings</h2>
    <p>Adjust your preferences:</p>
    <label for="greenThreshold">Threshold for green:</label>
    <input type="range" id="greenThreshold" min="0" max="300" value="230" oninput="updateGreenThreshold(this.value)">
    <span id="greenThresholdValue">230</span>
    <br>
    <label for="blueThreshold">Threshold for blue:</label>
    <input type="range" id="blueThreshold" min="0" max="300" value="230" oninput="updateBlueThreshold(this.value)">
    <span id="blueThresholdValue">230</span>
</div>

<script>
    const myVideo = document.createElement("video");
    navigator.mediaDevices.getUserMedia({ video: true }).then(function (rawData) {
        myVideo.srcObject = rawData;
        myVideo.play();
        myVideo.onloadeddata = function () {
            myCanvas.width = myVideo.videoWidth;
            myCanvas.height = myVideo.videoHeight;
            window.effect = new Effect(myCanvas, myVideo); // –°–æ–∑–¥–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –º–µ—Ç–æ–¥–∞–º
        };
    }).catch(function (err) {
        alert(err);
    });

    // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —à—Ç–æ—Ä–∫–∏
    function toggleSettings() {
        const panel = document.getElementById("settingsPanel");
        panel.classList.toggle("open");
    }

    // –ó–∞–∫—Ä—ã—Ç–∏–µ —à—Ç–æ—Ä–∫–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ—ë –æ–±–ª–∞—Å—Ç–∏
    document.addEventListener("click", (event) => {
        const panel = document.getElementById("settingsPanel");
        const button = document.querySelector(".settings-button");
        if (!panel.contains(event.target) && !button.contains(event.target) && panel.classList.contains("open")) {
            panel.classList.remove("open");
        }
    });

    // –§—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ—Ä–æ–≥–æ–≤
    function updateGreenThreshold(value) {
        document.getElementById("greenThresholdValue").textContent = value;
        if (window.effect) {
            window.effect.setGreenComponent(parseInt(value));
        }
    }

    function updateBlueThreshold(value) {
        document.getElementById("blueThresholdValue").textContent = value;
        if (window.effect) {
            window.effect.setBlueComponent(parseInt(value));
        }
    }
</script>

<script src="effect.js"></script>
<script src="utils.js"></script>
</body>
</html>
